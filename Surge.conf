[General]
# --- GENERAL ---
# Enhanced Wi-Fi Assist
wifi-assist = true
# Hybrid Network
all-hybrid = false
# Gaming Optimization
udp-priority = false
# Latency Benchmark
internet-test-url = http://connectivitycheck.platform.hicloud.com/generate_204
proxy-test-url = http://cp.cloudflare.com/generate_204
test-timeout = 3
# GeoIP Database
geoip-maxmind-url = https://github.com/Hackl0us/GeoIP2-CN/raw/release/Country.mmdb
# IPv6 Support
ipv6 = true
ipv6-vif = auto
# --- Wi-Fi ACCESS ---
allow-wifi-access = false
wifi-access-http-port = 6152
wifi-access-socks5-port = 6153
http-listen = 0.0.0.0:6152
socks5-listen = 0.0.0.0:6153
allow-hotspot-access = true
# --- REMOTE CONTROLLER ---
external-controller-access = steve@0.0.0.0:6160
http-api = steve@0.0.0.0:6166
http-api-tls = true
http-api-web-dashboard = true
# --- COMPATIBILITY ---
compatibility-mode = 1
# --- NETWORK ---
skip-proxy = localhost, *.local, captive.apple.com, guzzoni.apple.com, 0.0.0.0/8, 10.0.0.0/8, 17.0.0.0/8, 100.64.0.0/10, 127.0.0.0/8, 169.254.0.0/16, 172.16.0.0/12, 192.0.0.0/24, 192.0.2.0/24, 192.168.0.0/16, 192.88.99.0/24, 198.18.0.0/15, 198.51.100.0/24, 203.0.113.0/24, 224.0.0.0/4, 240.0.0.0/4, 255.255.255.255/32
exclude-simple-hostnames = true
use-default-policy-if-wifi-not-primary = false
# --- DNS ---
read-etc-hosts = true
use-local-host-item-for-proxy = true
encrypted-dns-follow-outbound-mode = false
include-all-networks = false
include-local-networks = false
dns-server = 223.5.5.5, 223.6.6.6, 119.29.29.29
encrypted-dns-server = https://doh.pub/dns-query, https://dns.alidns.com/dns-query
# --- ADVANCED ---
loglevel = notify
show-error-page-for-reject = true
force-http-engine-hosts = *.ott.cibntv.net, 123.59.31.1, 119.18.193.135, 122.14.246.33, 175.102.178.52, 116.253.24.*, 175.6.26.*, 220.169.153.*
always-real-ip = link-ip.nextdns.io, *.msftconnecttest.com, *.msftncsi.com, *.srv.nintendo.net, *.stun.playstation.net, xbox.*.microsoft.com, *.xboxlive.com, *.logon.battlenet.com.cn, *.logon.battle.net, stun.l.google.com
hijack-dns = 8.8.8.8:53, 8.8.4.4:53
udp-policy-not-supported-behaviour = REJECT

[Proxy]
🇰🇷 Korea_Snell = snell, 1.1.1.1, 2345, psk=steve, version=4, obfs=http, obfs-host=steve.me


[Proxy Group]
# 手动选择
NoAuto = select, Mainland, Automatic, no-alert=0, hidden=0, include-all-proxies=0, icon-url=https://raw.githubusercontent.com/sooyaaabo/Loon/main/Icon/App/Surge.png
# 自动选择
Automatic = url-test, "Hong Kong", Taiwan, Japan, Singapore, "United States", "United Kingdom", Korea, Snell, url=http://cp.cloudflare.com/generate_204, interval=300, tolerance=50, timeout=3, no-alert=0, hidden=0, include-all-proxies=0, icon-url=https://raw.githubusercontent.com/sooyaaabo/Loon/main/Icon/App/SteveWatch.png
# 订阅节点
AllServer = select, policy-path=你的订阅链接, update-interval=0, no-alert=0, hidden=0, include-all-proxies=0, policy-regex-filter=^((?!Remain|Expired|官网|如需|套餐|去除|剩余|距离|Reset|重置|流量).)+$, icon-url=https://raw.githubusercontent.com/sooyaaabo/Loon/main/Icon/App/Userscripts.png
# 代理选择
Proxy = select, Snell, Automatic, "Hong Kong", Taiwan, Singapore, Japan, "United States", "United Kingdom", no-alert=0, hidden=0, include-all-proxies=0, icon-url=https://raw.githubusercontent.com/sooyaaabo/Loon/main/Icon/App/Script-Hub-light.png
# Apple服务
Apple = select, Mainland, "Hong Kong", "United States", no-alert=0, hidden=0, include-all-proxies=0, icon-url=https://github.com/shindgewongxj/WHATSINStash/raw/main/icon/applespringloaded.png
# 哔哩哔哩
Bilibili = select, Mainland, "Hong Kong", Taiwan, icon-url=https://raw.githubusercontent.com/sooyaaabo/Loon/main/Icon/App/BilibiliRed.png
# Disney+
Disney+ = select, "Hong Kong", Singapore, no-alert=0, hidden=0, include-all-proxies=0, icon-url=https://github.com/shindgewongxj/WHATSINStash/raw/main/icon/disneyplus.png
# Netflix
Netflix = select, "Hong Kong", Taiwan, Singapore, Japan, "United States", no-alert=0, hidden=0, include-all-proxies=0, icon-url=https://raw.githubusercontent.com/sooyaaabo/Loon/main/Icon/App/Netflix.png
# Speedtest
Speedtest = select, Mainland, Automatic, AllServer, no-alert=0, hidden=0, include-all-proxies=0, icon-url=https://raw.githubusercontent.com/sooyaaabo/Loon/main/Icon/App/Speedtest.png
# Telegram
Telegram = select, Automatic, Singapore, "United States", Snell, "Hong Kong", Taiwan, Japan, no-alert=0, hidden=0, include-all-proxies=0, icon-url=https://raw.githubusercontent.com/sooyaaabo/Loon/main/Icon/App/Telegram-01.png
# TikTok
TikTok = select, Taiwan, Singapore, Japan, "United States", no-alert=0, hidden=0, include-all-proxies=0, icon-url=https://raw.githubusercontent.com/sooyaaabo/Loon/main/Icon/App/TikTok-01.png
# Twitter/X
Twitter = select, Automatic, "Hong Kong", Taiwan, Singapore, Japan, "United States", no-alert=0, hidden=0, include-all-proxies=0, icon-url=https://raw.githubusercontent.com/sooyaaabo/Loon/main/Icon/App/X-01.png
# YouTube
YouTube = select, Automatic, "Hong Kong", Taiwan, Singapore, Japan, "United States", no-alert=0, hidden=0, include-all-proxies=0, icon-url=https://raw.githubusercontent.com/sooyaaabo/Loon/main/Icon/App/YouTube.png
# AI服务
AI = select, "United States", Japan, Singapore, Snell, no-alert=0, hidden=0, include-all-proxies=0, icon-url=https://raw.githubusercontent.com/sooyaaabo/Loon/main/Icon/App/ChatGPT.png
# Microsoft
Microsoft = select, Mainland, "Hong Kong", Singapore, "United States", icon-url=https://raw.githubusercontent.com/sooyaaabo/Loon/main/Icon/App/Microsoft-04.png
# OneDrive
OneDrive = select, Mainland, "Hong Kong", Singapore, "United States", icon-url=https://raw.githubusercontent.com/sooyaaabo/Loon/main/Icon/App/MicrosoftOneDrive.png
# WeChat
WeChat = select, Mainland, "Hong Kong", Singapore, "United States", icon-url=https://raw.githubusercontent.com/sooyaaabo/Loon/main/Icon/App/WeChat.png
# 自建节点
Snell = select, "🇰🇷 Korea_Snell", no-alert=0, hidden=0, include-all-proxies=0, icon-url=https://raw.githubusercontent.com/sooyaaabo/Loon/main/Icon/App/MediaStorm.png
# 国内直连
Mainland = select, DIRECT, no-alert=0, hidden=0, include-all-proxies=0, icon-url=https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/China.png
# 地区分组
Hong Kong = url-test, update-interval=0, policy-regex-filter=港|🇭🇰|香港|HK|Hong, no-alert=0, hidden=0, include-all-proxies=0, include-other-group=AllServer, icon-url=https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Hong_Kong.png, url=http://cp.cloudflare.com/generate_204, interval=300, tolerance=50, timeout=3
Taiwan = url-test, update-interval=0, policy-regex-filter=台|🇹🇼|台湾|TW|Tai, no-alert=0, hidden=0, include-all-proxies=0, include-other-group=AllServer, icon-url=https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Taiwan.png, url=http://cp.cloudflare.com/generate_204, interval=300, tolerance=50, timeout=3
Japan = url-test, update-interval=0, policy-regex-filter=日|🇯🇵|日本|JP|Japan, no-alert=0, hidden=0, include-all-proxies=0, include-other-group=AllServer, icon-url=https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Japan.png, url=http://cp.cloudflare.com/generate_204, interval=300, tolerance=50, timeout=3
Singapore = url-test, update-interval=0, policy-regex-filter=坡|🇸🇬|新加坡|狮城|SG|Singapore, no-alert=0, hidden=0, include-all-proxies=0, include-other-group=AllServer, icon-url=https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Singapore.png, url=http://cp.cloudflare.com/generate_204, interval=300, tolerance=50, timeout=3
United States = url-test, update-interval=0, policy-regex-filter=美|🇺🇸|美国|US|States|American, no-alert=0, hidden=0, include-all-proxies=0, include-other-group=AllServer, icon-url=https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/United_States.png, url=http://cp.cloudflare.com/generate_204, interval=300, tolerance=50, timeout=3
United Kingdom = url-test, update-interval=0, policy-regex-filter=🇬🇧|英国|英|英格兰|UK|United Kingdom, no-alert=0, hidden=0, include-all-proxies=0, include-other-group=AllServer, icon-url=https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/United_Kingdom.png, url=http://cp.cloudflare.com/generate_204, interval=300, tolerance=50, timeout=3
Korea = url-test, update-interval=0, policy-regex-filter=韩|韩国|Korea|KR|🇰🇷, no-alert=0, hidden=0, include-all-proxies=0, include-other-group=AllServer, icon-url=https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Korea.png, url=http://cp.cloudflare.com/generate_204, interval=300, tolerance=50, timeout=3

[Rule]
# > Apple Intelligence
DOMAIN-SUFFIX,apple-relay.apple.com,AI
DOMAIN-SUFFIX,apple-relay.cloudflare.com,AI
DOMAIN-KEYWORD,apple-relay,AI

# > Ad Blocking
DOMAIN-SET,https://ruleset.skk.moe/List/domainset/reject.conf,REJECT
RULE-SET,https://ruleset.skk.moe/List/non_ip/reject-drop.conf,REJECT-DROP
RULE-SET,https://ruleset.skk.moe/List/non_ip/reject.conf,REJECT
RULE-SET,https://ruleset.skk.moe/List/ip/reject.conf,REJECT-DROP

# > Privacy & Security
DOMAIN,app-site-association.cdn-apple.com,REJECT
DOMAIN,prpr.96110.cn.com,DIRECT
DOMAIN-KEYWORD,96110,REJECT
DOMAIN-SUFFIX,gjfzpt.cn,REJECT

# > AI Services
DOMAIN-SUFFIX,googleapis.com,AI
RULE-SET,https://ruleset.skk.moe/List/non_ip/ai.conf,AI

# > Apple Services
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Surge/AppStore/AppStore.list,DIRECT
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Surge/AppleNews/AppleNews.list,United States
DOMAIN-SET,https://ruleset.skk.moe/List/domainset/apple_cdn.conf,Apple
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Surge/AppleTV/AppleTV.list,Apple
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Surge/Apple/Apple.list,Apple

# > Microsoft Services
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Surge/OneDrive/OneDrive.list,OneDrive
RULE-SET,https://ruleset.skk.moe/List/non_ip/microsoft.conf,Microsoft
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Surge/Bing/Bing.list,AI

# > Social Media & Communication
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Surge/WeChat/WeChat.list,WeChat
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Surge/Twitter/Twitter.list,Twitter
RULE-SET,https://ruleset.skk.moe/List/non_ip/telegram.conf,Telegram
RULE-SET,https://ruleset.skk.moe/List/ip/telegram.conf,Telegram
RULE-SET,https://ruleset.skk.moe/List/ip/telegram_asn.conf,Telegram
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Surge/Facebook/Facebook.list,Automatic
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Surge/Instagram/Instagram.list,Automatic
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Surge/Threads/Threads.list,Automatic
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Surge/Discord/Discord.list,Automatic

# > Streaming Media
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Surge/Disney/Disney.list,Disney+
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Surge/Netflix/Netflix.list,Netflix
RULE-SET,https://raw.githubusercontent.com/Semporia/TikTok-Unlock/master/Surge/TikTok.list,TikTok
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Surge/BiliBili/BiliBili.list,Bilibili
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Surge/YouTube/YouTube.list,YouTube
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Surge/GoogleSearch/GoogleSearch.list,YouTube
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Surge/Emby/Emby.list,Automatic

# > Regional Streaming
RULE-SET,https://ruleset.skk.moe/List/non_ip/stream_us.conf,United States
RULE-SET,https://ruleset.skk.moe/List/ip/stream_us.conf,United States
RULE-SET,https://ruleset.skk.moe/List/non_ip/stream_eu.conf,United Kingdom
RULE-SET,https://ruleset.skk.moe/List/ip/stream_eu.conf,United Kingdom
RULE-SET,https://ruleset.skk.moe/List/non_ip/stream_jp.conf,Japan
RULE-SET,https://ruleset.skk.moe/List/ip/stream_jp.conf,Japan
RULE-SET,https://ruleset.skk.moe/List/non_ip/stream_kr.conf,Korea
RULE-SET,https://ruleset.skk.moe/List/ip/stream_kr.conf,Korea
RULE-SET,https://ruleset.skk.moe/List/non_ip/stream_hk.conf,Hong Kong
RULE-SET,https://ruleset.skk.moe/List/ip/stream_hk.conf,Hong Kong
RULE-SET,https://ruleset.skk.moe/List/non_ip/stream_tw.conf,Taiwan
RULE-SET,https://ruleset.skk.moe/List/ip/stream_tw.conf,Taiwan

# > CDN
DOMAIN-SET,https://ruleset.skk.moe/List/domainset/cdn.conf,Automatic
RULE-SET,https://ruleset.skk.moe/List/non_ip/cdn.conf,Automatic

# > Development & Tools
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Surge/GitHub/GitHub.list,Automatic
RULE-SET,https://raw.githubusercontent.com/getsomecat/GetSomeCats/Surge/rule/substore.list,Automatic
DOMAIN-SUFFIX,vercel.app,Automatic
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Surge/Speedtest/Speedtest.list,Speedtest

# > Network Optimization
AND,((PROTOCOL,UDP), (DOMAIN-SUFFIX,googlevideo.com)),REJECT-NO-DROP
DOMAIN-SUFFIX,smtp,DIRECT
URL-REGEX,(Subject|HELO|SMTP),DIRECT

# > Games
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Surge/Riot/Riot.list,United States
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Surge/Tesla/Tesla.list,DIRECT

# > Cloud Services
DOMAIN-SUFFIX,mypikpak.com,United States

# > Music
RULE-SET,https://ruleset.skk.moe/List/non_ip/neteasemusic.conf,Mainland
RULE-SET,https://ruleset.skk.moe/List/ip/neteasemusic.conf,Mainland

# > Additional Services
DOMAIN-SUFFIX,nssurge.com,Automatic
DOMAIN-SUFFIX,surgee.me,Automatic
DOMAIN-SUFFIX,www.torrentmac.net,Automatic
DOMAIN-SUFFIX,cloudflare.com,Automatic
DOMAIN-SUFFIX,appstorrent.ru,DIRECT
DOMAIN,jable.tv,Automatic
DOMAIN,api.amplitude.com,Automatic
DOMAIN,m.cmx.im,Automatic
DOMAIN-SUFFIX,api.themoviedb.org,Automatic

# > Global Routing
RULE-SET,https://ruleset.skk.moe/List/non_ip/global_plus.conf,Automatic
RULE-SET,https://ruleset.skk.moe/List/non_ip/global.conf,Automatic

# > China Direct
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Surge/ChinaDNS/ChinaDNS.list,DIRECT
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Surge/ChinaMax/ChinaMax.list,DIRECT
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Surge/XiaoHongShu/XiaoHongShu.list,DIRECT
RULE-SET,https://ruleset.skk.moe/List/non_ip/domestic.conf,Mainland
RULE-SET,https://ruleset.skk.moe/List/non_ip/direct.conf,Mainland
RULE-SET,https://ruleset.skk.moe/List/ip/domestic.conf,Mainland
RULE-SET,https://raw.githubusercontent.com/VirgilClyne/GetSomeFries/main/ruleset/ASN.China.list,DIRECT

# > Downloads
DOMAIN-SET,https://ruleset.skk.moe/List/domainset/download.conf,Mainland
RULE-SET,https://ruleset.skk.moe/List/non_ip/download.conf,Mainland

# > System
RULE-SET,https://raw.githubusercontent.com/zxfccmm4/Profiles/refs/heads/main/Surge/Ruleset/Unbreak.list,DIRECT
RULE-SET,LAN,DIRECT

# > Final
FINAL,NoAuto,dns-failed

[Host]
*.taobao.com = server:223.5.5.5
*.tmall.com = server:223.5.5.5
*.alipay.com = server:223.5.5.5
*.alicdn.com = server:223.5.5.5
*.aliyun.com = server:223.5.5.5
*.jd.com = server:119.28.28.28
*.qq.com = server:119.28.28.28
*.tencent.com = server:119.28.28.28
*.weixin.com = server:119.28.28.28
*.bilibili.com = server:119.29.29.29
hdslb.com = server:119.29.29.29
*.163.com = server:119.29.29.29
*.126.com = server:119.29.29.29
*.126.net = server:119.29.29.29
*.127.net = server:119.29.29.29
*.netease.com = server:119.29.29.29
*.mi.com = server:119.29.29.29
*.xiaomi.com = server:119.29.29.29
*testflight.apple.com = server:8.8.4.4
# > Firebase Cloud Messaging
mtalk.google.com = 108.177.125.188
# > Google Dl
dl.google.com = server:119.29.29.29
dl.l.google.com = server:119.29.29.29
update.googleapis.com = server:119.29.29.29
# > Router Admin Panel
amplifi.lan = server:syslib // Ubiquiti Amplifi Router
router.synology.com = server:syslib // Synology Router
sila.razer.com = server:syslib // Razer Sila Router
router.asus.com = server:syslib // Asus Router
routerlogin.net = server:syslib // Netgear Router
orbilogin.com = server:syslib // Netgear Obri Router
www.LinksysSmartWiFi.com = server:syslib // Linksys Router
LinksysSmartWiFi.com = server:syslib // Linksys Router
myrouter.local = server:syslib // Linksys Router
www.miwifi.com = server:syslib // Xiaomi Mi WiFi Router
miwifi.com = server:syslib // Xiaomi Mi WiFi Router
mediarouter.home = server:syslib // Huawei Router
tplogin.cn = server:syslib // TP-Link Router
tplinklogin.net = server:syslib // TP-Link Router
melogin.cn = server:syslib // MERCURY Router
falogin.cn = server:syslib // FAST Router

[URL Rewrite]
# > Redirect Google Services
^https?:\/\/(www\.)?(g|google)\.cn https://www.google.com 302
^https?:\/\/(ditu|maps)\.google\.cn https://maps.google.com 302

# > HTTPS Redirects
^https?:\/\/(www\.)?taobao\.com\/ https://taobao.com/ 302
^https?:\/\/(www\.)?jd\.com\/ https://www.jd.com/ 302
^https?:\/\/(www\.)?mi\.com\/ https://www.mi.com/ 302
^https?:\/\/you\.163\.com\/ https://you.163.com/ 302
^https?:\/\/(www\.)?suning\.com\/ https://suning.com/ 302
^https?:\/\/(www\.)?yhd\.com\/ https://yhd.com/ 302

# > Service Optimizations
^https?:\/\/api\.abema\.io\/v\d\/ip\/check - reject

[Header Rewrite]
http-request ^https?:\/\/.*\.zhihu\.com\/(question|topic) header-replace User-Agent "osee2unifiedRelease/4432 osee2unifiedReleaseVersion/7.8.0 Mozilla/5.0 (iPhone; CPU iPhone OS 14_4 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Mo    bile/15E148"

# 解决github速率限制返回429问题
http-request ^https:\/\/github\.com\/ header-replace Accept-Language en-us
http-request ^https:\/\/(raw|gist)\.githubusercontent\.com\/ header-replace Accept-Language en-us

[MITM]
skip-server-cert-verify = true
tcp-connection = true
h2 = true
hostname = www.google.cn, api.abema.io, *.zhihu.com, -CUSTOMMitM, sub.store, github.com, raw.githubusercontent.com, gist.githubusercontent.com
  
